<template>
  <div ref="mainBox" class="main" :class="[readOnly === true ? 'onlyread' : '']" v-loading="loading">
    <!-- éŸ³é¢‘æ’­æ”¾ -->
    <div>
      <audio src="../../public/sound/click.mp3" ref="clickSound"></audio>
      <audio id="luckySound" src="../../public/sound/lucky.mp3" ref="luckySound"></audio>
    </div>
    <el-drawer :visible.sync="drawer" direction="btt" :with-header="false"
      style=" height: 100%; width: 100%; text-align: center;">
      <div class="kf_tel">
        <a href="tel:17710767031">è”ç³»æ–¹å¼ï¼š17710767031</a>
      </div>
    </el-drawer>
    <div class="headBox">
      <div class="guize" @click="dialogGuize = true">
        <img src="../../public/imgs/guize.jpg">
      </div>
      <div class="kf_bt" @click="drawer = true" type="primary" style="">
        <img src="../../public/imgs/kf_btn.png" alt="">
      </div>

      <!-- <div class="prize-box" @click="prizePage">
         <img src="../../public/imgs/myprize.jpg"> 
        <a>ä¸­å¥–è®°å½•></a>
      </div> -->
      <!-- è§„åˆ™å¼¹çª— -->
      <el-dialog :visible.sync="dialogGuize" width="100%" :show-close="showClose" :style="this.guizeStyle()">
        <div class="guize-box">
          <div class="guize-title">æ´»åŠ¨è§„åˆ™</div>
          <div class="guize-text">
            <div class="text-box">
              <p>ã€å‚ä¸æ–¹å¼ã€‘ç‚¹å‡»æŠ½å¥–æŒ‰é’®å³å¯å‚ä¸æ´»åŠ¨ï¼Œæ¦‚ç‡æ€§æŠ½ä¸­æ´»åŠ¨å¥–å“ã€‚</p>
              <p>ã€æ´»åŠ¨è§„åˆ™ã€‘æ¯ä½ç”¨æˆ·ä¸é™åˆ¶é™åˆ¶å‚ä¸æ¬¡æ•°ã€‚æœ¬æ´»åŠ¨ä¸ºæ¦‚ç‡ä¸­å¥–ï¼Œç”¨æˆ·æœ‰ä¸€å®šä¸­å¥–æ¦‚ç‡æŠ½ä¸­æ´»åŠ¨å¥–å“ã€‚</p>
              <p>ã€æ´»åŠ¨å¥–å“ã€‘ç‚¹å‡»å¥–å“é“¾æ¥åˆ°ç›¸å…³æœåŠ¡å‚å•†é¢†å–ã€‚</p>
              <p>ã€ç‰¹æ®Šè¯´æ˜ã€‘åœ¨æ´»åŠ¨ä¸­è·å¾—å¥–å“åï¼Œå¦‚é€€å‡ºæ´»åŠ¨ï¼Œå¯èƒ½å¯¼è‡´é“å…·æˆ–å¥–å“ä¸¢å¤±ï¼Œè¯·åœ¨è·å¥–ååŠæ—¶å…‘æ¢æˆ–é¢†å–ï¼Œé¿å…æŸå¤±ã€‚</p>
              <p>ä½¿ç”¨è¯´æ˜</p>
              <p>1.å‚ä¸æ´»åŠ¨åï¼Œä¸­å¥–çš„ç”¨æˆ·åº”åœ¨æ´»åŠ¨é¡µé¢ã€å¥–å“è¯¦æƒ…é¡µé¢æ‰€æç¤ºçš„æ—¶é—´å†…é¢†å¥–ï¼Œé€¾æœŸæœªé¢†ï¼Œå³è§†ä¸ºæ”¾å¼ƒã€‚</p>
              <p>2.é¢†å¥–åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»å¥–å“é“¾æ¥æˆ–ç›¸ä¼¼å­—æ ·ã€å›¾æ ‡ï¼ŒæŸ¥çœ‹å·²é¢†å–çš„å¥–å“åŠä½¿ç”¨è§„åˆ™ã€‚</p>
              <p>3.è¯·è®¤çœŸé˜…è¯»ä¼˜æƒ åˆ¸ã€å…‘æ¢åˆ¸çš„ä½¿ç”¨è§„åˆ™ï¼Œå¹¶æŒ‰ç…§ä¼˜æƒ åˆ¸ã€å…‘æ¢åˆ¸è¯¦æƒ…é¡µé¢çš„æç¤ºæ“ä½œã€‚</p>
              <p>4.å®ç‰©ç±»å¥–å“å°†åœ¨ä¸­å¥–åçš„30ä¸ªå·¥ä½œæ—¥å†…å‘è´§ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼›</p>
              <p>5.è¯è´¹ã€çº¢åŒ…ç­‰è™šæ‹Ÿå¥–å“å°†åœ¨ä¸­å¥–åçš„72å°æ—¶å†…å……å€¼è¿›ç”¨æˆ·å¡«å†™çš„è´¦å·ï¼Œå› ä¸ªäººåŸå› å¡«å†™é”™è¯¯ï¼Œå¯¼è‡´å……å€¼å¤±è´¥çš„ï¼Œä¸äºˆè¡¥å‘ã€‚</p>
              <p>6.å› ä¸å¯æŠ—åŠ›ã€æŠ€æœ¯æ•…éšœç­‰åŸå› ï¼Œæˆ‘ä»¬æœ‰æƒç›¸åº”è°ƒæ•´æˆ–ç»ˆæ­¢æ´»åŠ¨ï¼Œè€Œæ— éœ€å‘ç”¨æˆ·è¿›è¡Œèµ”å¿æˆ–è¡¥å¿ã€‚</p>
              <p>7.æ´»åŠ¨æœŸé—´å†…ï¼Œç”¨æˆ·å­˜åœ¨ä½œå¼Šç­‰è¿æ³•è¿è§„è¡Œä¸ºçš„ï¼Œå°†è¢«æ’¤é”€æŠ½å¥–èµ„æ ¼ã€å¥–å“ä½¿ç”¨èµ„æ ¼ï¼Œæ”¶å›å·²è·å¾—çš„æƒç›Šã€‚</p>
              <p>8.å¯¹æ´»åŠ¨è§„åˆ™ã€å¥–å“ä½¿ç”¨è§„åˆ™ã€å¥–å“é¢†å–ç­‰æœ‰ç–‘é—®çš„ï¼Œè¯·åœ¨å·¥ä½œæ—¥10:00-18:00ï¼Œè”ç³»ç´¢çŸ¥å®¢æœã€‚</p>
            </div>
          </div>
          <div class="guize-close" style="" @click="dialogGuize = false">
            <img src="../../public/imgs/x.png" style="width: 100%; height: 100%;">
          </div>
        </div>
      </el-dialog>
    </div>

    <div class="luckyBox">
      <LuckyWheel id="luckyWheel" ref="myLucky" width="32rem" height="32rem" :prizes="prizes" :blocks="blocks"
        :buttons="buttons" :defaultConfig="defaultConfig" @start="startCallback" @end="endCallback" />
      <div class="fixed-box">
        <img class="rotate" :class="[{ 'r1': shrinkPacket }, { 'r2': !shrinkPacket }]" src="../assets/finger.jpg" />
      </div>
    </div>
    <!-- å¥–å“å¼¹çª—,é®ç½©å±‚ -->
    <div class="popContainer" v-show="dialogVisible">
      <div class="guanbi" @click="closeWin">
        <img src="../../public/imgs/x.png" alt="">
      </div>
      <div class="dia-box" @click="toPath">
        <img class="figure" src="../../public/imgs/prizebg.png" alt="">
        <div class="prize_img_box" ref="prize_img_box">
          <img class="pirze-img" :src="this.luckyPrize.imgUrl" />
          <img class="prize_bg" src="../../public/imgs/huode_bg.png" alt="">
          <img class="prize_ling" src="../../public/imgs/lingqu.png" alt="">

        </div>
        <!-- <div class="prizeFont">å¿«é¢†ç›²ç›’å¤§å¥–</div> -->
        <!-- <div class="egg-box">
          <div class="img-box" v-for="(item, index) in eggArr" :key="index">
            <img v-show="item.isChuizi" ref="chuizi" class="chuizi" src="../../public/imgs/chuizi.png" alt="">
            <img style="width: 90%; position: absolute; bottom: 32%;" :src="item.prizeImg" alt="">
            <img :key="keyIndex" ref="egg" @click="clickEgg(item, index)" class="rotate-egg" :src="item.src"
              :class="[{ 'e1': eggstyle }, { 'e2': !eggstyle }]" />
          </div>
        </div> -->
      </div>
    </div>
    <div id="footer">
      ä¸»åŠå•ä½ï¼šç´¢çŸ¥ï¼ˆåŒ—äº¬ï¼‰ç§‘æŠ€æœ‰é™å…¬å¸<br>
      å®¢æœç”µè¯ï¼š17710767031<br>
      äº¬ICPå¤‡2021039592å·
      <!-- <a href="https://beian.miit.gov.cn/" style="color: #d96841;">äº¬ICPå¤‡2021039592å·</a> -->
    </div>
  </div>
</template>
<script>
//é»˜è®¤åœ¨#prize-dialogä¸‹é¢åˆ›å»ºcanvaså¼¹å‡º
import '../components/canvas-confetti'
import axios from 'axios'
import butten from "../assets/butten.jpg"
import Fingerprint2 from 'fingerprintjs2'
export default {
  name: 'RaffltNine',
  data() {
    return {
      //æ¥å£api
      // apiUrl: 'https://vapi.suozhikeji.cn/api',
      apiUrl: 'https://vapi.suozhikeji.cn',
      defaultImg: 'this.src="' + require('../../public/imgs/404.png') + '"',
      blocks: [{ padding: '13px', background: '#ea5f34' }],
      prizes: [
        {
          fonts: [{ seq: '0', text: '28å…ƒçº¢åŒ…', fontColor: '#ea4035', fontSize: '16', top: '10%' }],
          background: '#fdf4e9',
          imgs: [{ src: '../../imgs/28yuan.jpg', top: '28%', width: '37%', height: '' }]
        },
        {
          fonts: [{ seq: '1', text: '88å…ƒçº¢åŒ…', fontColor: '#ea4035', fontSize: '16', top: '10%' }],
          background: '#ffffff',
          imgs: [{ src: '../../imgs/88yuan.jpg', top: '28%', width: '37%', height: '' }]

        },
        {
          fonts: [{ seq: '2', text: '188å…ƒçº¢åŒ…', fontColor: '#ea4035', fontSize: '16', top: '10%' }],
          background: '#fdf4e9',
          imgs: [{ src: '../../imgs/188yuan.jpg', top: '28%', width: '37%', height: '' }]

        },
        {
          fonts: [{ seq: '3', text: '288å…ƒçº¢åŒ…', fontColor: '#ea4035', fontSize: '16', top: '10%' }],
          background: '#ffffff',
          imgs: [{ src: '../../imgs/288yuan.jpg', top: '28%', width: '37%', height: '' }]

        },
        {
          fonts: [{ seq: '4', text: 'å¹¸è¿ç¦è¢‹', fontColor: '#ea4035', fontSize: '16', top: '10%' }],
          background: '#fdf4e9',
          imgs: [{ src: '../../imgs/fudai.jpg', top: '28%', width: '37%', height: '' }]

        }, {
          fonts: [{ seq: '5', text: 'è°¢è°¢å‚ä¸', fontColor: '#ea4035', fontSize: '16', top: '10%' }],
          background: '#ffffff',
          imgs: [{ src: '../../imgs/again.jpg', top: '28%', width: '37%', height: '' }]

        },
      ],
      buttons: [{
        radius: '20%',
        background: '',
        pointer: true,
        //fonts: [{ text: 'å¼€å§‹', top: '-10px' }],
        imgs: [{
          src: butten,
          top: '-5rem',
          width: '8rem',
          height: '10rem'
        }]
      }],
      defaultConfig: {
        // gutter:'20px',
        accelerationTime: 500,
        decelerationTime: 1000,
        speed: 15
      },
      shrinkPacket: true,
      urlObj: {},//è¯·æ±‚é“¾æ¥æ•°æ®
      urlObj_b: {
        "logType": "",
        "eventTime": "",
        "deviceId": "",
        "deviceType": "",
        "idfa": "",
        "idfaMd5": "",
        "imei": "",
        "imeiMd5": "",
        "oaid": "",
        "oaidMd5": "",
        "androidId": "",
        "androidIdMd5": "",
        "osType": "",
        "osVersion": "",
        "mediaId": "",
        "positionId": "",
        "placeId": "",
        "schemeId": ""
      },
      prizeObj: {},//å¹¿å‘Šobjæ•°æ®
      prizeList: [],//å¹¿å‘Šlist
      luckyPrize: {},//ä¸­å¥–å•†å“
      // imgurl: 'https://vapi.suozhikeji.cn/prod-api',
      logObj: {
        "logType": "",
        "logTime": "",
        "searchId": "",
        "deviceId": "",
        "deviceType": "",
        "idfa": "",
        "idfv": "",
        "caid1": "",
        "caid2": "",
        "idfaMd5": "",
        "idfvMd5": "",
        "imei": "",
        "imeiMd5": "",
        "oaid": "",
        "oaidMd5": "",
        "androidId": "",
        "androidIdMd5": "",
        "osType": "",
        "osVersion": "",
        "isTest": "",
        "mediaId": "",
        "positionId": "",
        "placeId": "",
        "advertiserId": "",
        "accountId": "",
        "planId": "",
        "creativeType": "",
        "creativeId": "",
        "materialId": "",
        "abTag": "",
        "packageName": "com.taobao.market",
        "transType": "",
        "bidType": "",
        "targetType": "",
        "schemeId": "",
        "pageId": "",
        "templateId": "",
        "ideaId": ""
      },//æ—¥å¿—æ•°æ®
      dialogVisible: false,
      dialogGuize: false,
      showClose: false,
      loading: false,
      timer: '',
      eggtimer: '',
      eggstyle: true,
      eggArr: [
        { index: 0, src: '../../imgs/egg.png', prizeImg: '', isChuizi: false },
        { index: 1, src: '../../imgs/egg.png', prizeImg: '', isChuizi: false },
        { index: 2, src: '../../imgs/egg.png', prizeImg: '', isChuizi: false },
      ],
      keyIndex: 0,
      //æ˜¯å¦ç¦ç”¨ç‚¹å‡»
      readOnly: false,
      deviceFinger: '',
      drawer: false,
    }
  },

  methods: {
    //å®¢æœäº‹ä»¶
    kfEvent() {

    },
    //è‡ªåŠ¨æ’­æ”¾éŸ³é¢‘
    audio() {
      if (typeof WeixinJSBridge === "undefined") {
        //æœªæ‰§è¡ŒWeixinJSBridge å¼€å§‹ç›‘å¬ WeixinJSBridge
        document.addEventListener('WeixinJSBridgeReady', () => {
          // alert('2')
          this.$refs.luckySound.play();
        }, false);
      } else {
        //å·²ç»æ‰§è¡Œ ä½¿ç”¨ getNetworkType è°ƒç”¨è·å–ç½‘ç»œç±»å‹åæ‰§è¡Œ
        WeixinJSBridge.invoke("getNetworkType", {}, () => {
          // alert('1')
          this.$refs.luckySound.play();
        });
      }
      // alert('3')

      // this.$refs.luckySound.play();
    },
    //å¤„ç†å¹¿å‘Šæ¥å£å‚æ•°
    dealSearchParm() {
      let keyarr = Object.keys(this.urlObj)
      for (let i = 0; i < Object.keys(this.urlObj_b).length; i++) {
        let key = Object.keys(this.urlObj_b)[i]
        // è¿”å›å€¼ç­‰äº-1 è¯´æ˜æ•°ç»„keyarrä¸­ä¸å­˜åœ¨itemä¸ºkeyçš„å¯¹è±¡
        if (keyarr.findIndex(item => item === key) == -1) {
          this.urlObj[key] = ''
          if (key == 'deviceId' || this.urlObj.deviceId == '') {
            this.urlObj.deviceId = this.$cookies.get('murmur')
          }
          if (key == 'eventTime') {
            this.urlObj.eventTime = this.createTime.currentTime();
          }
        }
      }
    },
    //è·å–æµè§ˆå™¨çš„å”¯ä¸€æ ‡è¯†ç¬¦
    createFingerprint() {
      let that = this
      Fingerprint2.get(function (components) {
        const values = components.map(function (component, index) {
          if (index === 0) { //æŠŠå¾®ä¿¡æµè§ˆå™¨é‡ŒUAçš„wifiæˆ–4Gç­‰ç½‘ç»œæ›¿æ¢æˆç©º,ä¸ç„¶åˆ‡æ¢ç½‘ç»œä¼šIDä¸ä¸€æ ·
            return component.value.replace(/\bNetType\/\w+\b/, '')
          }
          return component.value
        })
        // ç”Ÿæˆæœ€ç»ˆid murmur   
        const murmur = Fingerprint2.x64hash128(values.join(''), 31);
        that.$cookies.set("murmur", murmur);
      })
    },
    //ç ¸è›‹äº‹ä»¶
    clickEgg(item, index) {
      this.eggArr[index].isChuizi = true
      setTimeout(() => {
        this.$refs.chuizi[index].style.transform = 'rotate(0deg)';
        //å–æ¶ˆæ‘‡è›‹
        clearInterval(this.eggtimer);
        let arr = this.eggArr
        for (let i = 0; i < arr.length; i++) {
          //æ¢å¤è›‹çš„æ°´å¹³ä½ç½®
          this.$refs.egg[i].style.transform = 'rotate(0deg)'
          if (index == i) {
            this.eggArr[i].src = '../../imgs/egg-bad.png'
            this.eggArr[i].prizeImg = this.luckyPrize.imgUrl
          } else {
            this.eggArr[i].prizeImg = '../../imgs/yihan.png'
          }
        }
        //æœªé€‰ä¸­çš„ğŸ¥šç­‰ä¸€ä¼šåœ¨ç¢
        setTimeout(() => {
          for (let i = 0; i < arr.length; i++) {
            if (index != i) {
              this.eggArr[i].src = '../../imgs/egg-bad.png'
              this.eggArr[i].prizeImg = '../../imgs/yihan.png'
            }
          }
        }, 1000);
      }, 200);
      //è·³è½¬
      setTimeout(() => {
        this.toPath()
      }, 2000);
      this.readOnly = true
    },
    guizeStyle() {
      return {
        position: 'relative',
        padding: '0',
      }
    },
    //å¼¹å‡ºçª—å…³é—­
    closeWin() {
      this.dialogVisible = false
      this.$refs.prize_img_box.style = 'width: 1%;height: 1%;'

      this.keyIndex++
      for (let i = 0; i < this.eggArr.length; i++) {
        this.eggArr[i].src = '../../imgs/egg.png'
        this.eggArr[i].prizeImg = ''
        this.eggArr[i].isChuizi = false
      }
    },
    //è·å–çª—å£å¤§å°è®¾ç½®ç»™é¡µé¢
    setWin() {
      this.winWidth = window.innerWidth;
      this.winHeight = window.innerHeight;
      this.$refs.mainBox.style.height = this.winHeight + 'px'
      this.$refs.mainBox.style.width = this.winWidth + 'px'
    },
    //ç‚¹å‡»æŠ½å¥–æŒ‰é’®
    startCallback() {
      console.log();
      // this.audio()
      // è°ƒç”¨æŠ½å¥–ç»„ä»¶çš„playæ–¹æ³•å¼€å§‹æ¸¸æˆ
      this.$refs.myLucky.play()
      this.$refs.clickSound.play();
      this.readOnly = true
      // æ¨¡æ‹Ÿè°ƒç”¨æ¥å£å¼‚æ­¥æŠ½å¥–
      setTimeout(() => {
        this.getPrize().then(res => {
          // å‡è®¾åç«¯è¿”å›çš„ä¸­å¥–ç´¢å¼•æ˜¯0
          // è°ƒç”¨stopåœæ­¢æ—‹è½¬å¹¶ä¼ é€’ä¸­å¥–ç´¢å¼•
          const index = res.data.data.seq - 1
          this.$refs.myLucky.stop(index)
        }).catch(err => {
          this.$refs.myLucky.stop(5)
        });
      }, 2000)
    },
    //äº”å½©ç¤¼èŠ±
    lihua() {
      //  this.$refs.luckySound.play();
      this.audio()
      confetti({
        spread: 70,
        particleCount: 100,
        origin: { y: 0.5 }
      });
    },
    //æŠ½å¥–ç»“æŸ
    endCallback(prize) {
      setTimeout(() => {
        if (prize.fonts[0].seq == 5) {
          this.$message({
            message: 'è°¢è°¢å‚ä¸',
            type: 'info',
            duration: 3000,
            offset: 300
          });
          return
        }
        this.luckyPrize = prize.ement
        this.luckyPrize.imgUrl = this.domainUrl(this.luckyPrize.imgUrl)
        this.dialogVisible = true
        setTimeout(() => {
          this.$refs.prize_img_box.style = 'width: 100%;height: 100%;'
        }, 100);
        //æ˜¾ç¤ºå¥–å“ä¿¡æ¯ç‚¹ç”¨æ—¥å¿—21
        this.getLog(21)
        this.lihua()
        this.eggRotate()
        this.readOnly = false
      }, 500);

    },
    //è›‹æŠ–åŠ¨
    eggRotate() {
      clearInterval(this.eggtimer);
      this.eggtimer = setInterval(() => {
        this.eggstyle = !this.eggstyle
      }, 500);
    },
    //æ‰‹æŒ‡æŠ–åŠ¨
    startRotate() {
      clearInterval(this.timer);
      this.timer = setInterval(() => {
        this.shrinkPacket = !this.shrinkPacket
      }, 450);
    },
    //æ¥å—ä¸Šçº§é¡µé¢ä¼ å…¥å‚æ•°
    getQuery(query) {
      if (typeof (query) == "string") {
        this.urlObj = this.getParm.getParmOfUrl(query)
        return
      }
      if (query == undefined | query == null | Object.keys(query).length == 0) {
        //å¦‚æœæ²¡æœ‰å…¥å‚å°±æŒ‰é»˜è®¤æ•°æ®è¯·æ±‚æ¥å£
        this.dealSearchParm()
        return
      }
      this.urlObj = query
    },
    //è°ƒç”¨å¹¿å‘Šå•†å“æ¥å£
    getSearch() {
      var that = this
      // console.log(JSON.stringify(this.urlObj));
      var config = {
        method: 'post',
        url: that.apiUrl + `/api/ads/search`,
        header: {
          'Content-Type': 'application/json'
        },
        data: this.urlObj
      };
      axios(config)
        .then(function (res) {
          // console.log('Search-success', res);
          that.dealData(res.data.data)
          //é¡µé¢åŠ è½½å®Œæˆè°ƒç”¨æ—¥å¿—æ¥å£20
          that.getLog(20)
        })
        .catch(function (error) {
          // console.log('Search-err', error);
        });
    },
    //æ—¥å¿—æ¥å£
    getLog(logtype) {
      this.dealLog(logtype)
      let that = this;
      var config = {
        method: 'post',
        url: that.apiUrl + '/api/event/trace',
        header: {
          'Content-Type': 'application/json'
        },
        data: this.logObj
      };
      axios(config)
        .then(function (response) {
          // console.log('log-success', response);
        })
        .catch(function (error) {
          // console.log('log-err', error);
        });
    },
    //å¤„ç†å¹¿å‘Šå¥–å“æ•°æ®
    dealData(obj) {
      this.prizeObj = obj
      this.prizeList = obj.advertisement
      //å¥–å“æ”¾å…¥è½¬ç›˜
      var arr = obj.advertisement
      for (let i = 0; i < Math.min(5, arr.length); i++) {
        this.prizes[i].fonts[0].text = arr[i].titleMain
        this.prizes[i].fonts[0].seq = arr[i].seq
        this.prizes[i].imgs[0].src = this.domainUrl(arr[i].imgUrl)
        this.prizes[i].imgs[0].top = '35%'
        this.prizes[i].ement = arr[i]
      }
    },
    //æ—¥å¿—æ•°æ®æ•´ç†
    dealLog(logtype) {
      this.logObj.logType = logtype;
      this.logObj.logTime = this.createTime.currentTime();
      this.logObj.searchId = this.prizeObj.search_id;
      this.logObj.deviceId = this.urlObj.deviceId;
      this.logObj.deviceType = this.urlObj.deviceType;
      // IOS: IDFA > IDFV  ;   Android: IMEI > OAID > AndroidIDï¼› æ²¡æœ‰çš„è¯å‰ç«¯ç”Ÿæˆcookie
      this.logObj.caid1 = '';
      this.logObj.caid2 = '';
      for (let i = 0; i < Object.keys(this.urlObj).length; i++) {
        if (Object.keys(this.urlObj)[i] == 'idfa') {
          this.logObj.idfa = this.urlObj.idfa;//idfaã€idfväºŒé€‰ä¸€
          this.logObj.idfaMd5 = this.urlObj.idfaMd5;//idfaMd5ã€idfvMd5äºŒé€‰ä¸€
        } else if (Object.keys(this.urlObj)[i] == 'idfv') {
          this.logObj.idfv = this.urlObj.idfv;//idfaã€idfväºŒé€‰ä¸€
          this.logObj.idfvMd5 = this.urlObj.idfvMd5;//idfaMd5ã€idfvMd5äºŒé€‰ä¸€
        }
      }
      this.logObj.imei = this.urlObj.imei;
      this.logObj.imeiMd5 = this.urlObj.imeiMd5;
      this.logObj.oaid = this.urlObj.oaid;
      this.logObj.oaidMd5 = this.urlObj.oaidMd5;
      this.logObj.androidId = this.urlObj.androidId;
      this.logObj.androidIdMd5 = this.urlObj.androidIdMd5;
      this.logObj.osType = this.urlObj.osType;
      this.logObj.osVersion = this.urlObj.osVersion;
      this.logObj.isTest = '';
      this.logObj.mediaId = this.urlObj.mediaId;
      this.logObj.positionId = this.urlObj.positionId;
      this.logObj.packageName = '';
      this.logObj.placeId = '123';
      this.logObj.advertiserId = '';
      this.logObj.accountId = this.luckyPrize.accountId;
      this.logObj.planId = this.luckyPrize.planId;
      this.logObj.creativeType = '';
      this.logObj.creativeId = this.luckyPrize.creativeId;
      this.logObj.materialId = '';
      this.logObj.abTag = '';
      this.logObj.transType = '';
      this.logObj.bidType = this.luckyPrize.bidType;
      this.logObj.targetType = '';
      this.logObj.ideaId = this.urlObj.ideaId;
      this.logObj.templateId = this.urlObj.templateId;
      this.logObj.pageId = this.urlObj.pageId;
      this.logObj.schemeId = this.urlObj.schemeId;

      this.filteLog(this.logObj)
    },
    //è¿‡æ»¤æ—¥å¿—æ¥å£æ¯ä¸ªå‚æ•°
    filteLog(obj) {
      for (let i = 0; i < Object.keys(obj).length; i++) {
        if (Object.values(obj)[i] === undefined || Object.values(obj)[i] === '' || Object.values(obj)[i] === '-' || Object.values(obj)[i] === null) {
          let aaa = Object.keys(obj)[i]
          this.$set(this.logObj, aaa, '-9999')
        }
      }
    },
    //æ£€æŸ¥é“¾æ¥æ˜¯å¦ä¸ºåŸŸå
    domainUrl(url) {
      if (url.includes('https')) {
        return url
      } else {
        return 'https://' + url
      }
    },
    //ä¸­å¥–æ¥å£
    async getPrize() {
      let that = this;
      let data;
      var config = {
        method: 'get',
        url: that.apiUrl + '/api/luck/prize',
        header: {
          'Content-Type': 'application/json'
        },
      };
      await axios(config)
        .then(function (res) {
          data = res
          // console.log('prize-success', res);
        })
        .catch(function (error) {
          // console.log('prize-err', error);
        });
      return data
    },
    //è·³è½¬é“¾æ¥
    toPath() {
      // console.log(this.luckyPrize);
      //æ˜¾ç¤ºå¥–å“ä¿¡æ¯ç‚¹ç”¨æ—¥å¿—21
      this.getLog(22)
      let urlstr = '?' + 'mediaId=' + this.logObj.mediaId + '&positionId=' + this.logObj.positionId
        + '&planId=' + this.logObj.planId + '&deviceId=' + this.logObj.deviceId + '&deviceType=' + this.logObj.deviceType
        + '&imeiMd5=' + this.logObj.imeiMd5 + '&osType=' + this.logObj.osType + '&oaidMd5=' + this.logObj.oaidMd5 + '&schemeId=' + this.logObj.schemeId
        + '&accountId=' + this.luckyPrize.accountId + '&creativeId=' + this.logObj.creativeId + '&searchId=' + this.logObj.searchId + '&pageId=' + this.urlObj.pageId
        + '&templateId=' + this.urlObj.templateId
      let url = this.domainUrl(this.luckyPrize.landUrl) + urlstr
      window.location.href = url
      // console.log(urlstr);
    },
    //ç›‘å¬å›¾ç‰‡æ¸²æŸ“å®Œæˆ
    imgListen() {
      let imglis = document.getElementsByTagName('img')
      for (let i = 0; i < imglis.length; i++) {
        if (imglis[i].complete == false) {
          return false
        }
        return true
      }
    },
    //å¥–å“é¡µé¢
    prizePage() {
      // console.log('è·³è½¬é¡µé¢');
    },
  },

  mounted() {
    this.createFingerprint()
    this.setWin()
    this.imgListen()
    this.startRotate()
    this.getQuery(this.$route.query)
    this.dealSearchParm()
    setTimeout(() => {
      this.getSearch()
    }, 600);
  },
  created() { },
}
</script>
<style lang="less" >
.el-drawer__container {
  position: relative; 
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
}

.el-drawer__body {
  height: 10%;
}

.kf_tel {
  height: 30%;
  width: 100%;
  font-size: 2rem;
  text-align: center;
  display: flex;
  justify-content: center;
  /*ä½¿å­é¡¹ç›®æ°´å¹³å±…ä¸­*/
  align-items: center;

  a {
    color: #5e8df7;

  }
}

.kf_bt {
  bottom: 0;
  position: absolute;
  height: 15%;
  width: 13%;

  img {
    height: 100%;
  }
}



.prize_img_box {
  // transition: 2s all ease .1s;
  transition-duration: 2s;
  height: 1%;
  width: 1%;
  position: relative;
  display: flex;
  justify-content: center;
  /*ä½¿å­é¡¹ç›®æ°´å¹³å±…ä¸­*/
  align-items: center;

  /*ä½¿å­é¡¹ç›®å‚ç›´å±…ä¸­*/
  // &:hover {
  //   // transform: scale(100);
  //   width: 100%;
  //   height: 100%;
  // }
}

.pirze-img {
  position: absolute;
  z-index: 1;
  width: 76%;
  height: 29%;
  border-radius: 10px;
  border: 2px solid white;
}

.prize_ling {
  position: absolute;
  width: 25%;
  z-index: 2;
  bottom: 17%;
}

.prize_bg {
  position: absolute;
  width: 90%;
  z-index: 0;
}

.el-message {
  min-width: 30%;
}

//å»æ‰é€šçŸ¥çš„iocnå›¾æ ‡
.el-icon-info:before {
  content: "";
}

.onlyread {
  pointer-events: none;
}

.chuizi {
  transform: rotate(30deg);
  transform-origin: right bottom; //æ—‹è½¬ä¸­å¿ƒ
  position: absolute;
  right: -3%;
  width: 60%;
  height: 40%;
  z-index: 9;
}

.guanbi {
  position: absolute;
  top: 15%;
  right: 8%;
  width: 6%;
  z-index: 1;

  img {
    width: 100%;
  }
}

.e1 {
  transform: rotate(-8deg);
}

.e2 {
  transform: rotate(8deg);
}

.egg-box {
  position: absolute;
  bottom: 0;
  height: 28%;
  width: 100%;
}

.img-box {
  height: 100%;
  width: 22%;
  margin: 5.5%;
  display: flex;
  justify-content: center;
  /*ä½¿å­é¡¹ç›®æ°´å¹³å±…ä¸­*/
  float: left;
  position: relative;
}

.rotate-egg {
  width: 100%;
  bottom: 0;
  position: absolute;
}

// æ—‹è½¬å›¾ç‰‡
.figure {
  position: absolute;
  z-index: 0; //å±‚çº§
  width: 100%;
  animation: 0ms;
  -webkit-animation: rotateImg 3s linear infinite;
  vertical-align: middle;
}

@keyframes rotateImg {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

@-webkit-keyframes rotateImg {
  0% {
    -webkit-transform: rotate(0deg);
  }

  100% {
    -webkit-transform: rotate(360deg);
  }
}

.popContainer {
  position: absolute;
  display: flex;
  justify-content: center;
  /*ä½¿å­é¡¹ç›®æ°´å¹³å±…ä¸­*/
  align-items: center;
  /*ä½¿å­é¡¹ç›®å‚ç›´å±…ä¸­*/
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
}

.prize-box {
  position: absolute;
  bottom: 2%;
  right: 2%;
  height: 10%;
  font-size: 1.5rem;
  color: #cd5642;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 2px solid;

  img {
    height: 100%;
  }
}

.guize-close {
  height: 2.5rem;
  width: 2.5rem;
  position: absolute;
  top: 5%;
  right: 6%;
}

.guize-text {
  position: relative;
  height: 70%;
  width: 76%;
  top: 29%;
  margin: auto;
  box-sizing: border-box;

}

.text-box {
  height: 100%;
  width: 100%;
  overflow: auto;
  font-size: 1rem;
  line-height: 2.1rem;
  overflow-y: scroll;
  height: calc(100%);
  padding-right: 3%;
}

.guize-title {
  position: absolute;
  width: 100%;
  top: 14%;
  text-align: center;
  font-size: 2.5rem;
  color: #f8e4b4;
}

.el-dialog__header {
  padding: 0;
}

.el-dialog__body {
  padding: 0;
}

.guize-box {
  margin: auto;
  height: 44rem;
  background-image: url(../../public/imgs/guizebg2.jpg);
  background-size: 100% 100%;
}

.guize {
  position: absolute;
  top: 2%;
  left: 1%;
  height: 12%;

  img {
    height: 100%;
  }
}

.dia-box {
  position: relative;
  height: 65%;
  width: 100%;
  // text-align: center;
  display: flex;
  justify-content: center;
  /*ä½¿å­é¡¹ç›®æ°´å¹³å±…ä¸­*/
  align-items: center;
  /*ä½¿å­é¡¹ç›®å‚ç›´å±…ä¸­*/

}



.el-dialog {
  top: 20%;
  background-color: rgb(0 0 0 / 0%);
  box-shadow: 0 0 0 0 rgba(0, 0, 0, .0);

}

.prizeFont {
  position: absolute;
  bottom: 20%;
  width: 100%;
  text-align: center;
  color: #f6dfb2;
  font-size: 3rem;
  font-weight: bold;
}

//å–æ¶ˆè¶…é“¾æ¥çš„ä¸‹åˆ’çº¿
a {
  text-decoration: none
}

#footer {
  height: 7%;
  width: 100%;
  position: absolute;
  bottom: 2%;
  text-align: center;
  color: #d96841;
  font-size: 13px;
}

.el-message-box {
  display: inline-block;
  width: 80%;
  padding-bottom: 0;
  vertical-align: middle;
  background-color: rgb(0 0 0 / 0%);
  border-radius: 0;
  border: 0px solid #EBEEF5;
  font-size: 18px;
  box-shadow: 0 0 0 0 rgba(0, 0, 0, .0);
  text-align: left;
  overflow: hidden;
  backface-visibility: hidden;
}

.fixed-box {
  position: relative;
  top: 50%;
  left: 55%;
  width: 6rem;
  height: 7rem;
  transform-origin: right bottom;

  img {
    width: 100%;
    height: 100%;
  }

  .r1 {
    transform: rotate(-8deg);
  }

  .r2 {
    transform: rotate(8deg);
  }
}

.luckyBox {
  width: 100%;
  height: 46%;
  position: relative;
}

#luckyWheel {
  height: 100%;
  width: 100%;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}

.headBox {
  top: auto;
  right: auto;
  bottom: auto;
  left: auto;
  height: 27%;
  position: relative;
}

.main {
  background-image: url(../assets/tray.jpg);
  background-size: 100% 100%;
  background-repeat: no-repeat;
}

body {
  background-color: #f8e4b4;
}
</style>
  